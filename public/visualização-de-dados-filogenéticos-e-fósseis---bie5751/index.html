<!DOCTYPE html>
<html lang="pt-br">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "/"
        },
        "articleSection" : "post",
        "name" : "Visualização de dados filogenéticos e fósseis - BIE5751",
        "headline" : "Visualização de dados filogenéticos e fósseis - BIE5751",
        "description" : "A ideia por trás desse tutorial é ter um primeiro contato com os principais tipos de dados usados em Macroevolução. Os exercícios propostos aqui serão retomados com maior detalhe no próximo tutorial, que será feito diretamente no R, então no momento não se preocupe em saber como as coisas são feitas, e busque só se familiarizar com os diferentes tipos de dados.
Usaremos uma ferramenta interativa que permite a visualização instantânea e simplificada de comandos do R, usando o pacote shiny.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2018",
        "datePublished": "2018-09-17 00:00:00 &#43;0000 UTC",
        "dateModified" : "2018-09-17 00:00:00 &#43;0000 UTC",
        "url" : "/visualiza%C3%A7%C3%A3o-de-dados-filogen%C3%A9ticos-e-f%C3%B3sseis---bie5751/",
        "wordCount" : "1281",
        "image" : /%!s(&lt;nil&gt;)",
        "keywords" : [ "R","Tutorial","Macroevolução","Visualização","Blog" ]   
    }
    </script>


 <title>Visualização de dados filogenéticos e fósseis - BIE5751 </title>


<meta name="description" content="Um blog para registrar ideias, reflexões e tutoriais." />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">
<link rel="stylesheet" href="/css/font-awesome.min.css" type='text/css' media='all'>

<link href="/css/style.css" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="/css/custom.css" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-118334548-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>


<body class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">

  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fa fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/ensino">ensino</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/r">r</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/script">script</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/tutorial">tutorial</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    
    <li>
      <a href="https://www.twitter.com/gustavoburin" data-animate-hover="pulse" class="twitter" target="_blank">
        <i class="fa fa-twitter-square" title="twitter"></i>
        <span class="screen-reader-text">twitter</span>
      </a>
    </li>
    

    
    <li>
      <a href="https://www.instagram.com/gburin_ari" data-animate-hover="pulse" class="twitter" target="_blank">
        <i class="fa fa-instagram" title="instagram"></i>
        <span class="screen-reader-text">instagram</span>
      </a>
    </li>
    

    
    <li>
      <a href="mailto:arietebio@gmail.com" data-animate-hover="pulse" class="email">
        <i class="fa fa-envelope" title="email"></i>
        <span class="screen-reader-text">email</span>
      </a>
    </li>
    

    

    


    
    <li>
      <a href="https://www.github.com/gburin" data-animate-hover="pulse" class="github" target="_blank">
        <i class="fa fa-github" title="github"></i>
        <span class="screen-reader-text">github</span>
      </a>
    </li>
    


    

    


  </ul></div>

      </div>

      <div class="container">
        <div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Textos, ideias e tutoriais de uma mente bagunçada. </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fa fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      
  
  
    map[]
  
  
  <div id="loop-container" class="loop-container">
    

      <div class="post type-post status-publish format-standard hentry category-standard category-travel entry full-without-featured odd excerpt-1">

        
        <div class="entry-meta">
          <span class="date">17 September</span>	<span> / </span>

          <span class="author">
            <a href="/" title="Posts by " rel="author"></a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/R">R</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Visualização de dados filogenéticos e fósseis - BIE5751</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <p>A ideia por trás desse tutorial é ter um primeiro contato com os principais tipos de dados usados em Macroevolução. Os exercícios propostos aqui serão retomados com maior detalhe no próximo tutorial, que será feito diretamente no R, então no momento não se preocupe em saber <em>como</em> as coisas são feitas, e busque só se familiarizar com os diferentes tipos de dados.</p>
<p>Usaremos uma ferramenta interativa que permite a visualização instantânea e simplificada de comandos do R, usando o pacote <em>shiny</em>. Esta ferramenta ainda está em desenvolvimento, então por favor nos avise dos possíveis problemas que encontrarem ao longo da aula para que possamos arrumá-los em versões futuras! (Para salvar as figuras geradas, clique com o botão direito do mouse e depois em “Salvar Imagem Como…”)</p>
<p>O código necessário para usar a ferramenta está <a href="https://github.com/labmeme/labmeme.github.io/blob/master/phylo_fossil_vis_new.R">neste arquivo</a>. Para salvá-lo, clique com o botão direito no link e depois em “Salvar link como…”, e então salvá-lo no diretório de sua escolha. Para abrir o arquivo basta clicar duas vezes para abrí-lo no RStudio. No topo da janela do arquivo com o código, clique no botão escrito “Run App” para rodar a ferramenta.</p>
<div id="filogenias-moleculares" class="section level1">
<h1>Filogenias Moleculares</h1>
<p>Com a ferramenta aberta e funcionando, vamos simular filogenias que resultam de diferentes combinações entre taxas de especiação e extinção. Por enquanto usaremos apenas modelos de taxas constantes ao longo do tempo por simplicidade, mas mais para frente no curso veremos que essa condição pode ser relaxada de diferentes formas.</p>
<div id="nascimento-puro-pure-birth-ou-yule" class="section level2">
<h2>Nascimento puro (Pure Birth ou Yule)</h2>
<p>Os parâmetros definidos por padrão na ferramenta (especiação = <strong>0.2</strong> e extinção = <strong>0</strong>) já estão prontos para serem usados em simulações de um processo de nascimento puro (Pure birth). Para gerar uma nova simulação, basta clicar no botão “Rodar Simulação”. Cada vez que você clicar, uma nova simulação será feita e plotada na mesma janela. A ferramenta plota duas filogenias: a de cima é a filogenia completa e a de baixo é a filogenia molecular. Ainda, existe um checkbox com a opção “Mostrar LTT Plot”, que quando marcado plota também um gráfico com o número de linhagens vivas ao longo do tempo.</p>
<div id="simulacoes" class="section level3">
<h3>Simulações</h3>
<p>Inicialmente, simule e analise calmamente uma árvore usando as taxas pré-definidas (lembre-se de nesse passo não alterar as taxas de extinção, que devem permanecer em <strong>0</strong>). Observe que as duas filogenias plotadas são sempre idênticas. Por que isso acontece?</p>
<p>Em seguida, repita o processo acima algumas vezes sem mexer nos parâmetros. O que é possível dizer sobre o número de espécies final das filogenias geradas? E sobre as curvas de diversidade?</p>
</div>
<div id="relacao-entre-taxa-e-tempo" class="section level3">
<h3>Relação entre taxa e tempo</h3>
<p>No próximo passo, a ideia é comparar a interação entre a taxa de especiação e a idade do clado. Antes de simular, o que você espera de árvores geradas sob um mesmo regime (i.e. taxas) porém com idades diferentes?</p>
<p>Para analisarmos essa dualidade nas árvores, você deve simular algumas árvores com uma mesma taxa de especiação (<strong>0.2</strong>) e idade (<strong>15</strong>). Em cada etapa, estime o número total de espécies formadas e anote esses valores.</p>
<p>Em seguida, altere a idade do clado simulado para <strong>30</strong>, mantendo a taxa de especiação sem alterações (<strong>0.2</strong>). Novamente simule diferentes árvores e anote o número estimado total de espécies formadas.</p>
<p>Agora compare os valores entre os dois cenários. Quão diferentes são as árvores geradas? Você consegue propor um modelo de crescimento (linear, exponencial, logístico) que possa explicar essas diferenças?</p>
<p>Por fim, retorne o valor da idade para <strong>10</strong>, mas agora ajuste o valor de especiação para <strong>0.4</strong>, e repita os passos acima. Quais conclusões é possível tirar baseados nesses resultados?</p>
</div>
</div>
<div id="nascimento-e-morte-birth-death" class="section level2">
<h2>Nascimento e morte (Birth-Death)</h2>
<p>Nesta parte do tutorial, vamos analisar como a extinção afeta a filogenia (e consequentemente as curvas de diversidade e os LTT plots).</p>
<div id="simulacoes-1" class="section level3">
<h3>Simulações</h3>
<p>Inicialmente, ajuste a taxa de especiação para <strong>0.3</strong> e aumente a taxa de extinção para <strong>0.1</strong>, e também ajuste o tempo para <strong>20</strong>. Note que com essa combinação de taxas, o “saldo” de diversificação (especiação - extinção) é positivo e com igual valor (<strong>0.2</strong>) ao que iniciamos a parte anterior do tutorial, porém agora com efeito da extinção. Comparando as duas filogenias plotadas (com especial atenção na filogenia molecular, no gráfico de baixo), o que se pode dizer sobre a assinatura que a extinção deixa nessas filogenias e nas curvas de diversidade? Repita este procedimento algumas vezes para ganhar intuição sobre o processo.</p>
<p>Simule também árvores geradas por diferentes combinações de especiação e extinção. Somente ccuidado com a combinação dos parâmetros, pois valores muito extremos podem fazer o R travar. Caso isso por acaso aconteça, basta fechar a janela da ferramenta e clicar em “Run App” novamente.</p>
</div>
<div id="saldo-0-ou-negativo" class="section level3">
<h3>“Saldo” 0 (ou negativo)</h3>
<p>Por fim, rode simulações com a taxa de extinção sendo igual à taxa de especiação (ambas em <strong>0.4</strong>). O que acontece, e por que? Vale também tentar simular árvores com as taxas de extinção ligeiramente maiores que as de especiação para ver o que acontece!</p>
</div>
</div>
</div>
<div id="registro-fossil" class="section level1">
<h1>Registro Fóssil</h1>
<p>Vamos agora simular o outro tipo de dados comumente usados em macroevolução. O registro fóssil tem vantagens e desvantagens quando comparado às filogenias moleculares, e essas diferenças serão abordadas ao longo do curso.</p>
<p>Assim como no caso das filogenias, usaremos modelos estocásticos de nascimento puro ou nascimento e morte.</p>
<blockquote>
<p>Importante: as funções de simulação de registro fóssil são mais lentas do que as funções para gerar filogenias. Sendo assim, ao clicar nos botões para gerar as simulações, espere alguns segundos para que a simulação seja terminada, pois no caso de repetidos cliques no botão de simulação, o R pode travar.</p>
</blockquote>
<p>Para cada simulação serão plotados 3 gráficos: o primeiro (painel esquerdo) representa a duração ou as ocorrências das linhagens simuladas (que podem ser observadas usando o botão de seleção “Tipo de Gráfico”); no painel direito, dividido em 2, serão plotados histogramas das durações (em milhões de anos) das espécies da simulação. O painel superior representa as durações sabendo-se o exato momento de surgimento e desaparecimento das espécies, enquanto que o painel inferior representa as durações calculadas a partir da primeira e última ocorrências dos fósseis.</p>
<div id="nascimento-puro-pure-birth-ou-yule-1" class="section level2">
<h2>Nascimento Puro (Pure Birth ou Yule)</h2>
<div id="simulacoes-2" class="section level3">
<h3>Simulações</h3>
<p>De maneira análoga às simulações para filogenias moleculares, simule diferentes registros fósseis usando os valores definidos por padrão na ferramenta (especiação = <strong>0.2</strong>, extinção = <strong>0</strong>, número total de espécies = <strong>30</strong>, preservação = <strong>100</strong>). Para cada simulação, observe a duração das espécies alternando entre os dois tipos de visualização (Duração e Ocorrências). Analise também os dois histogramas das durações das linhagens, comparando isso com as representações das durações das linhagens.</p>
<div id="importancia-da-qualidade-do-registro" class="section level4">
<h4>Importância da qualidade do registro</h4>
<p>Na próxima etapa, ajuste o valor de preservação para <strong>50%</strong> e novamente simule diferentes histórias. Alternando entre os dois tipos de visualização dos dados, e também avaliando as diferenças entre os histogramas, o que é possível inferir sobre como a qualidade do registro fóssil afeta as nossas estimativas de duração das espécies? Em um caso ainda mais extremo, ajuste o valor de preservação para <strong>10%</strong>.</p>
</div>
</div>
</div>
<div id="nascimento-e-morte-birth-death-1" class="section level2">
<h2>Nascimento e Morte (Birth Death)</h2>
<div id="simulacoes-3" class="section level3">
<h3>Simulações</h3>
<p>Repita os passos anteriores, porém agora usando taxas de especiação de <strong>0.3</strong> e taxas de extinção de <strong>0.1</strong> (retornando a preservação para <strong>100%</strong>). Simulando diferentes histórias, o que é possível notar de diferente nesse cenário quando comparado ao anterior?</p>
<p>Em seguida, repita as mudanças nos valores de preservação (para <strong>50%</strong> e depois para <strong>10%</strong>), e também compare as durações e os histogramas, alternando entre os dois tipos de visualização.</p>
</div>
</div>
</div>
<div id="resumo" class="section level1">
<h1>Resumo</h1>
<p>Este tutorial foi pensado para que permita um primeiro contato com os principais tipos de dados que usamos em macroevolução, porém sem usar ou expor a maquinaria estatística/computacional por trás. Na próxima aula, veremos os códigos usados para gerar a ferramenta, bem como exploraremos um pouco mais as característas dos processos geradores de diversidade.</p>
</div>

            </article>
          </div>
          
      <div class='entry-meta-bottom'>
        

  <div class="entry-categories"><p><span>Categories</span>
    
    <a href="/categories/r" title="View all posts in R">R</a>
  </p>
</div>



<div class="entry-tags"><p><span>Tags</span>
  
  <a href="/tags/r" title="View all posts tagged R">R</a>
  
  <a href="/tags/tutorial" title="View all posts tagged Tutorial">Tutorial</a>
  
  <a href="/tags/macroevolu%C3%A7%C3%A3o" title="View all posts tagged Macroevolução">Macroevolução</a>
  
  <a href="/tags/visualiza%C3%A7%C3%A3o" title="View all posts tagged Visualização">Visualização</a>
  

</p></div>	</div>

	
</div>
</div>

<section id="comments" class="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gburin" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  




</section>
</div>

 



    </div>

    <footer id="site-footer" class="site-footer" role="contentinfo">
	<h1>
    
    <a href=""> Textos, ideias e tutoriais de uma mente bagunçada. </a>
    
	</h1>

			

		<div id="menu-footer" class="menu-container menu-footer" role="navigation">
		<div class="menu">

      <ul id="menu-footer-items" class="menu-footer-items">
        
        <li id="menu-item" class="menu-item menu-item-type-post_type menu-item-object-page menu-item"><a href="/about/">Sobre</a></li>
        
</ul>

</div>	</div>

<ul class="social-media-icons">

        

        


        
        <li>
        <a href="https://www.twitter.com/gustavoburin"  class="twitter" target="_blank">
            <i class="fa fa-twitter-square" title="twitter"></i>
            <span class="screen-reader-text">twitter</span>
        </a>
        </li>
        

        
        <li>
        <a href="https://www.instagram.com/gburin_ari"  class="twitter" target="_blank">
            <i class="fa fa-instagram" title="instagram"></i>
            <span class="screen-reader-text">instagram</span>
        </a>
        </li>
        

        
        <li>
        <a href="mailto:arietebio@gmail.com"  class="email">
            <i class="fa fa-envelope" title="email"></i>
            <span class="screen-reader-text">email</span>
        </a>
        </li>
        

        

        


        
        <li>
        <a href="https://www.github.com/gburin"  class="github" target="_blank">
            <i class="fa fa-github" title="github"></i>
            <span class="screen-reader-text">github</span>
        </a>
        </li>
        


        

        

				</ul>	<div class="design-credit">
		
		<p>
			Nederburg Hugo Theme by <a target="_blank" href="https://appernetic.io">Appernetic</a>.
		</p>
		<p>
			A port of Tracks by Compete Themes.
		</p>
		
	</div>
</footer>

  </div>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquerymigrate.js"></script>
<script src="/js/production.min.js"></script>

</body>
</html>
